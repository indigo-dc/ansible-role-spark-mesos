{
    "id": "/spark-shuffle-service",
    "cmd": "/usr/bin/docker run --network host -e ZOOKEEPER_HOST_LIST={{zookeeper_peers_nodes}} {{spark_mesos_image}}:base /opt/spark/bin/spark-class org.apache.spark.deploy.mesos.MesosExternalShuffleService",
    "cpus": 0.1,
    "mem": 64,
    "disk": 0,
    "instances": {{ spark_mesos_slave_num }},
    "constraints": [
      [
        "hostname",
        "UNIQUE"
      ]
    ],
    "acceptedResourceRoles": [
      "*"
    ],
    "portDefinitions": [
      {
        "port": 10001,
        "protocol": "tcp",
        "name": "default",
        "labels": {}
      }
    ],
    "user": "root",
    "healthChecks": [
      {
        "command": {
          "value": "[ -z `pgrep java` ] && echo '1' || echo '0';"
        },
        "gracePeriodSeconds": 300,
        "intervalSeconds": 60,
        "maxConsecutiveFailures": 3,
        "protocol": "COMMAND",
        "ipProtocol": "IPv4",
        "timeoutSeconds": 20,
        "delaySeconds": 15
      }
    ]
  }