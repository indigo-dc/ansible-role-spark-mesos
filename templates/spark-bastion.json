{
  "id": "/spark-bastion",
  "cpus": 0.5,
  "mem": 1024,
  "instances": 1,
  "container":{
    "type" : "DOCKER",
    "docker": {
      "image" : "{{spark_mesos_image}}:bastion",
      "network": "HOST",
      "privileged": true,
      "forcePullImage": true
    }
  },
  "env": {
     "ZOOKEEPER_HOST_LIST":"{{zookeeper_peers_nodes}}",
     "CONTAINER_TARGET": "{{ bastion_target }}",
     "JUPYTER_PASSWORD": "{{ jupyter_password }}"
  },
  "healthChecks": [
    {% if bastion_target == "SSH" %}
    {
      "command": {
        "value": "[ -z `pgrep sshd` ] && echo '1' || echo '0';"
        
      },
      "gracePeriodSeconds": 300,
      "intervalSeconds": 60,
      "maxConsecutiveFailures": 3,
      "protocol": "COMMAND",
      "ipProtocol": "IPv4",
      "timeoutSeconds": 20,
      "delaySeconds": 15
    }
    {% endif %}
  ]
}
